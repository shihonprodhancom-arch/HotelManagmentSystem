<div class="container mt-4">
  <h2 class="mb-4">Hotel Bookings</h2>

  <!-- Booking Form -->
  <!-- <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <h5 class="card-title">{{ editingBookingId ? 'Edit Booking' : 'Add Booking' }}</h5>
      <form (ngSubmit)="addOrUpdateBooking(booking)">
        <div class="row g-2">
          <div class="col-md-3">
            <input type="text" class="form-control" placeholder="Guest Name" [(ngModel)]="booking.guest" name="guest">
          </div>
          <div class="col-md-2">
            <select class="form-select" [(ngModel)]="booking.room" name="room">
              <option *ngFor="let room of rooms" [value]="room.number">{{ room.number }} - {{ room.type }}</option>
            </select>
          </div>
          <div class="col-md-2">
            <input type="date" class="form-control" [(ngModel)]="booking.checkin" name="checkin">
          </div>
          <div class="col-md-2">
            <input type="date" class="form-control" [(ngModel)]="booking.checkout" name="checkout">
          </div>
          <div class="col-md-1">
            <input type="number" class="form-control" placeholder="Guests" [(ngModel)]="booking.guests" name="guests">
          </div>
          <div class="col-md-2">
            <button type="submit" class="btn btn-primary w-100">{{ editingBookingId ? 'Update' : 'Add' }}</button>
          </div>
        </div>
      </form>
    </div>
  </div> -->


  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <h5 class="card-title">{{ editingBookingId ? 'Edit Booking' : 'Add Booking' }}</h5>
      <form (ngSubmit)="addOrUpdateBooking(booking)">
        <div class="row g-3">
          <!-- Guest Name -->
          <div class="col-md-4">
            <input type="text" class="form-control" placeholder="Guest Name" [(ngModel)]="booking.guest" name="guest" required>
          </div>

          <!-- Room Selection -->
          <div class="col-md-3">
            <select class="form-select" [(ngModel)]="booking.room" name="room" required (change)="updateRoomPrice()">
              <option [ngValue]="room.number" *ngFor="let room of rooms">
                {{ room.number }} - {{ room.type }} (৳{{ room.price }})
              </option>
            </select>
          </div>

          <!-- Number of Guests -->
          <div class="col-md-2">
            <input type="number" class="form-control" placeholder="Guests" [(ngModel)]="booking.guests" name="guests" min="1" required (input)="updateRoomPrice()">
          </div>

          <!-- Check-in -->
          <div class="col-md-3">
            <input type="date" class="form-control" [(ngModel)]="booking.checkin" name="checkin" required (change)="validateDates()">
          </div>

          <!-- Check-out -->
          <div class="col-md-4">
            <input type="date" class="form-control" [(ngModel)]="booking.checkout" name="checkout" required (change)="validateDates()">
          </div>

          <!-- Total Price (readonly) -->
          <div class="col-md-4">
            <input type="text" class="form-control" [value]="'৳' + (booking.totalPrice || 0)" readonly placeholder="Total Price">
          </div>

          <!-- Payment Method -->
          <div class="col-md-4">
            <select class="form-select" [(ngModel)]="booking.paymentMethod" name="paymentMethod">
              <option value="" disabled selected>Select Payment</option>
              <option *ngFor="let method of paymentMethods" [value]="method">{{ method }}</option>
            </select>
          </div>

<div class="row g-3 mt-3">
  <div class="col-12">
    <label class="form-label"><strong>Additional Services</strong></label>
  </div>

  <div class="col-md-3" *ngFor="let service of extraServices">
    <div class="form-check">
      <!-- <input
        class="form-check-input"
        type="checkbox"
        [checked]="isServiceSelected(service)"
        (change)="toggleService(service, $event.target?.checked)"> -->

<input
  type="checkbox"
  class="form-check-input"
  #checkbox
  [checked]="isServiceSelected(service)"
  (change)="toggleService(service, checkbox.checked)">


      <label class="form-check-label">
        {{ service.name }} (+৳{{ service.price }})
      </label>
    </div>
  </div>
</div>



          <!-- Submit Button -->
          <div class="col-md-12">
            <button type="submit" class="btn btn-primary w-100">
              {{ editingBookingId ? 'Update Booking' : 'Add Booking' }}
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>







  <!-- Booking Cards -->
  <div class="row g-3">
    <div class="col-md-4" *ngFor="let booking of bookings; let i = index">
      <div class="card h-100 shadow-sm"
           [ngClass]="{
             'border-warning': booking.status === 'Pending',
             'border-success': booking.status === 'Paid',
             'border-danger': booking.status === 'Cancelled'
           }">
        <div class="card-header text-white"
             [ngStyle]="{'background-color': booking.status === 'Pending' ? '#FFC107' : booking.status === 'Paid' ? '#28A745' : '#DC3545'}">
          {{ booking.status }}
        </div>
        <div class="card-body">
          <h5 class="card-title">{{ booking.guestName }}</h5>
          <p class="card-text">
            <strong>Room:</strong> {{ booking.roomNumber }}<br>
            <strong>Check-in:</strong> {{ booking.checkInDate }}<br>
            <strong>Check-out:</strong> {{ booking.checkOutDate }}<br>
            <strong>Total Price:</strong> {{ booking.totalPrice }} ৳<br>
            <strong>Payment Method:</strong> {{ booking.paymentMethod || '-' }}
          </p>
        </div>
        <div class="card-footer d-flex flex-wrap gap-2">
          <button class="btn btn-success btn-sm"
                  (click)="payBooking(i)"
                  [disabled]="booking.status === 'Paid' || booking.status === 'Cancelled'">Pay</button>
          <button class="btn btn-warning btn-sm"
                  (click)="cancelBooking(i)"
                  [disabled]="booking.status === 'Cancelled'">Cancel</button>
          <button class="btn btn-info btn-sm" (click)="editBooking(booking)">Edit</button>
          <button class="btn btn-danger btn-sm" (click)="deleteBooking(booking.id)">Delete</button>
          <button class="btn btn-secondary btn-sm" (click)="printReceipt(booking)">Print</button>
        </div>
      </div>
    </div>
  </div>
</div>
